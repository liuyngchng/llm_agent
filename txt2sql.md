

## 1. 功能

该系统支持语音输入，输出与问题相关的数据表格，并进行图表渲染，系统功能点如表 1-1 所示。

**表 1-1 系统功能点**

| **No** | **功能点**        | **功能说明**                                               |
| ------ | ----------------- | ---------------------------------------------------------- |
| 1      | 自然语言转SQL语句 | 通过大模型将自然语言翻译成 SQL语句，这是这个系统的核心价值 |
| 2      | 数据表绘图        | 通过chart.js 将数据内容绘制成可视化的饼图、柱状图、曲线图  |
| 3      | 语音输入          | 支持通过语音输入问题，实现用户通过语音交互                 |
| 4      | 通过特定词语唤醒  | 通过一个特定词语唤醒问数功能                               |

## 2. 数据源

系统读取的数据源用户可自行配置， 若用户没有配置数据源，则使用系统内置的样例数据。数据源中的表结构样例如表 2-1 所示。

 **表 1-2 表结构 demo**

| 编号 | **字段名**       | **字段类型** | **字段注释*                              |
| ---- | ---------------- | ------------ | ---------------------------------------- |
| 1    | id               | 数字         | 订单信息表                               |
| 2    | 订单ID           | 数字         | 订单的唯一编号                           |
| 3    | 省               | 文本         | 中国国内的省份                           |
| 4    | 市               | 文本         |                                          |
| 5    | 区               | 文本         |                                          |
| 6    | 县               | 文本         |                                          |
| 7    | 公司名称         | 文本         |                                          |
| 8    | 商品名称         | 文本         | 具体销售的产品名称                       |
| 9    | 年               | 数字         | 年份，2025                               |
| 10   | 月               | 数字         | 订单形成的具体月份， 5                   |
| 11   | 日               | 数字         | 具体的日期，2025-01-01                   |
| 12   | 支付方式         | 文本         | 通过什么渠道进行的资金支付，固定的几个值 |
| 13   | 支付金额         | 数字         | 33218.123                                |
| 14   | 支付金额单位     | 文本         | 支付金额的单位，例如人民币、美元、港币等 |
| 15   | 厂商名称         | 文本         |                                          |
| 16   | 收入             | 数字         | 123.456                                  |
| 17   | 收入单位         | 文本         | 万元                                     |
| 18   | 支出             | 数字         | 0.321                                    |
| 19   | 支出单位         | 文本         | 万元                                     |
| 20   | 注册设备数量     | 数字         |                                          |
| 21   | 活跃设备数量     | 数字         |                                          |
| 22   | 用气量           | 数字         | 123.456                                  |
| 23   | 用气量单位       | 文本         | 方，立方米                               |
| 24   | 新增用户数量     | 数字         | 13                                       |
| 25   | 新增用户数量单位 | 文本         | 户                                       |
| 26   | 新增账户数量     | 数字         | 12                                       |
| 27   | 新增账户数量单位 | 文本         | 个                                       |
| 28   |                  |              |                                          |

就目前LLM 的能力， 如果想达到较好的效果，需要注意以下几点。

（1）表的数量尽量少。

（2）表名、表字段名称尽量使用汉字。

（3）字段类型尽可能简单，如数字、文本。

（4）字段信息尽可能冗余，不需要考虑3NF约束。例如，表1-2中的字段 “年”、“月” 和 “日” 的关系。

（5）表结构信息需要有自明性，信息具有通用性。例如，表1-2中的 “支付金额” 字段和“支付金额单位”的关系。

## 3. 核心功能

将自然语言转换为SQL语句，一共需要如下几个步骤。

（1）建立详细的表结构。

（2）将表结构提交给大模型。

（3）将需要问的问题提交给大语言模型。

（4）获取大语言模型返回的SQL。

（5）使用SQL查询数据。

## 4. 场景

（1）作为一些固定报表展示系统的有益补充。txt2sql 的优势在于比较灵活，但在响应时间、准确性上略有不足。

（2）在一些环境中，无法直接用手操作计算机（例如，配送员），那么通过语音输入，再通过语音转文本，txt2sql,可进行个人的一些业务范围内的信息查询。

（3）可以辅助对一些复杂系统的多次操作进行简化。例如查询某个信息，分别需要操作A, B, C, D, E，一共需要5步（例如，某些医院的挂号信息系统）。那么通过txt2sql， 直接在对话输入框中输出所需查询的信息，可提升用户使用体验。