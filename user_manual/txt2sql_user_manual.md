<center><h1>智能问数系统用户使用手册</h1></center>

## 1. 系统简介

智能问数系统是一款基于大语言模型的自然语言转SQL查询工具。用户可以通过自然语言描述查询需求，系统会自动将其转换为SQL语句并执行查询，最终以表格形式展示查询结果。

## 2. 系统界面概览

### 2.1 登录页面

登录页面是用户进入系统的入口界面，包含以下元素：
- 用户名输入框：输入已注册的用户名
- 密码输入框：输入对应用户的密码
- 登录按钮：提交登录请求
- 用户注册链接：跳转到新用户注册页面
- 使用说明链接：查看系统使用手册
- 忘记密码链接：找回忘记的密码（功能待实现）

### 2.2 注册页面

注册页面用于创建新用户账户，包含以下元素：
- 用户名输入框：设置新用户名
- 密码输入框：设置登录密码
- 注册按钮：提交注册请求
- 返回登录链接：返回系统登录页面

### 2.3 主查询页面

主查询页面是系统的核心功能界面，包含以下元素：
- 查询输入框：输入自然语言查询需求
- 语音输入按钮：通过语音方式输入查询需求
- 查询执行按钮：提交查询请求
- 导航链接区域：包含数据源配置、提示词配置等快捷链接
- 结果展示区域：显示查询结果和可视化图表
- 状态指示器：显示系统处理状态

### 2.4 数据源配置页面

数据源配置页面用于设置数据库连接信息，包含以下元素：
- 数据库类型选择：支持多种数据库类型
- 数据库连接参数输入：主机、端口、用户名、密码等
- 高级配置选项：表清单、绘图开关、严格搜索等
- 操作按钮：保存配置或删除配置

## 3. 详细操作指南

### 3.1 用户登录

1. 打开系统登录页面
2. 在 `用户名` 输入框中输入已注册的用户名
3. 在 `密码` 输入框中输入对应密码
4. 点击 `登录` 按钮或按回车键进入系统
5. 登录成功后将跳转到主查询页面

### 3.2 新用户注册

1. 在登录页面点击"用户注册"链接
2. 在注册页面的 `用户名` 输入框中输入希望设置的用户名
3. 在 `密码` 输入框中设置登录密码
4. 点击"注册账户"按钮完成注册
5. 注册成功后可使用新账户登录系统

### 3.3 数据源配置

#### 3.3.1 配置数据库连接

1. 登录系统后，在主界面点击"数据源配置"链接
2. 根据实际使用的数据库类型填写相应信息。

支持的数据库类型：
- `SQLite`：SQLite 数据库
- `MySQL`：MySQL 数据库
- `Oracle`：Oracle 数据库
- `Doris`：Doris 数据源
- `达梦`：达梦数据库(DM8)

#### 3.3.2 配置字段说明

| 字段名 | 说明 |
|--------|------|
| 数据库类型 | 选择要连接的数据库类型 |
| 数据库名称 | 填写数据库实例名 |
| 数据库主机 | 填写数据库服务器地址 |
| 数据库端口 | 填写数据库服务端口 |
| 数据库用户 | 填写有访问权限的用户名 |
| 数据库密码 | 填写对应用户密码 |
| 数据表清单 | 限定可访问的表（逗号分隔），留空则使用所有可见表 |
| 开启提示 | 设置为1时会在查询条件不明确时提示用户补充信息 |
| 开启绘图 | 设置为1时会为查询结果生成可视化图表 |
| 背景知识 | 输入业务相关的背景信息，帮助系统更好地理解查询需求 |

 配置完成后点击"保存配置"按钮

#### 3.3.3 删除数据源配置

1. 在数据源配置页面点击"删除配置"按钮
2. 确认删除操作
3. 配置删除后将使用系统默认数据源

### 3.4 智能问数功能

#### 3.4.1 基本查询

1. 在主界面输入框中输入自然语言查询请求，例如："查询2024年各地区的用户数量"
2. 点击"查询"按钮或按回车键
3. 系统将自动：
   - 优化您的问题描述
   - 生成对应的SQL语句
   - 执行查询并展示数据表格
   - 根据数据表格生成图表
   - 给出数据查询解释说明

#### 3.4.2 分页查询

当查询结果较多时，系统会自动分页展示：
- 每页显示 100 条记录
- 在结果底部会显示总记录数和总页数
- 点击"下一页"可查看后续数据

### 3.5 语音识别功能

系统支持语音输入查询：

1. 在主查询页面点击输入框旁边的麦克风图标
2. 授权浏览器使用麦克风权限
3. 说出您的查询需求
4. 系统会自动识别语音并转换为文字进行查询

## 4. 高级功能

### 4.1 用户提示词定制

通过定制提示词模板，可以优化系统的行为：

1. 登录系统后，在主界面点击"提示词配置"链接
2. 可以修改两个关键提示词：
   - 问题优化提示词：用于优化用户输入的问题
   - SQL生成提示词：用于指导SQL生成过程
3. 修改后点击"保存"生效

注意事项：
- 问题优化提示词必须包含变量：`{data_source_info}`（数据源信息）和 `{user_short_q_desc}`（用户提问）
  - SQL生成提示词必须包含变量：`{sql_dialect}`（SQL 方言）、`{schema}`（数据库模式）、`{chat_history}`（对话历史）、`{max_record_per_page}`（每页最大记录数）

### 4.2 用户提问偏好配置

通过配置提问偏好配置，可以让系统能够更加懂得用户的个人偏好，提供优质的回答：

1. 登录系统后，在主界面点击"问题解释配置"链接（仅管理员可见）
2. 在文本框中输入业务规则，每行需要包含至少一个空格或制表符
3. 保存后系统会在处理问题时参考这些规则

## 5. 界面元素说明

### 5.1 主查询页面元素

- **查询输入框** (`dialog`)：输入自然语言查询需求
- **语音按钮** (`voice-btn`)：点击后可通过语音输入查询需求
- **查询按钮** (`startBtn`)：提交查询请求
- **导航链接**：
  - 数据源配置：配置数据库连接信息
  - 提示词配置：自定义系统提示词
  - 问题解释配置：配置业务规则（仅管理员可见）
  - 退出：安全退出系统
- **状态指示器** (`status-indicator`)：显示系统处理状态
- **结果展示区** (`stream_output`)：展示查询结果和图表

### 5.2 数据源配置页面元素

- **数据库类型下拉框** ：选择要连接的数据库类型
- **数据库名称输入框** ：填写数据库实例名
- **数据库主机输入框** ：填写数据库服务器地址
- **数据库端口输入框** ：填写数据库服务端口
- **数据库用户输入框** ：填写有访问权限的用户名
- **数据库密码输入框** ：填写对应用户密码
- **数据表清单输入框** ：限定可访问的数据表
- **开启提示输入框** ：设置是否启用查询条件校验（0或1）
- **开启绘图输入框** ：设置是否生成图表（0或1）
- **背景知识文本框** ：输入业务背景信息
- **保存配置按钮** ：保存当前配置
- **删除配置按钮** ：删除当前配置

## 6. 常见问题

### 6.1 查询结果为空怎么办？

- 检查查询条件是否过于严格
- 尝试扩大时间范围或放宽条件
- 确认数据源中是否存在相关数据

### 6.2 生成的SQL不正确怎么办？

- 尝试更详细地描述查询需求
- 检查数据源配置是否正确
- 联系管理员检查系统配置

### 6.3 如何提高查询准确性？

- 在问题中明确指定时间、地理范围
- 使用具体的业务术语
- 配置相关的个人偏好信息

### 6.4 支持哪些数据库？

系统支持以下数据库：
- SQLite
- MySQL
- Oracle
- Doris
- DM8（达梦数据库）

### 6.5 查询结果如何导出？

目前系统以HTML表格形式展示查询结果，您可以：
- 使用浏览器的打印功能保存为PDF
- 手动复制表格数据到Excel等工具中

## 7. 技术支持

如在使用过程中遇到问题，请联系系统管理员或技术支持团队。
