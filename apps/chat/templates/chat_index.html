<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 助手</title>
    <link rel="stylesheet" href="/static/chat.css">
    <link rel="stylesheet" href="/static/font-awesome.6.0.0.all.min.css">
    <link rel="stylesheet" href="/static/highlight.11.8.0.github.min.css">

</head>
<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-robot"></i> AI 助手</h1>
            <div class="model-info">
                <span id="modelName">正在加载模型信息...</span>
                <div class="model-info-actions">
                    <button id="clearChat" class="btn-clear">
                        <i class="fas fa-trash-alt"></i> 清空聊天
                    </button>
                    <a href="/logout?uid={{uid}}&app_source={{app_source}}" class="btn-logout">
                        <i class="fas fa-sign-out-alt"></i> 退出
                    </a>
                </div>
            </div>
            <div class="home-nav" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <a href="/document_chat?uid={{uid}}&t={{t}}&app_source={{app_source}}"
                   class="btn-doc-chat"
                   style="text-decoration: none; padding: 8px 16px; border-radius: 6px; background: #4b6cb7; color: white;">
                    <i class="fas fa-file-alt"></i> 文档问答
                </a>
            </div>
        </header>

        <div class="chat-container">
            <div class="chat-history" id="chatHistory">
                <!-- 聊天消息会动态添加到这里 -->
                <div class="welcome-message">
                    <p>👋 你好！我是AI助手，有什么可以帮你的吗？</p>
                </div>
            </div>

            <div class="input-area">
                <div class="input-container">
                    <div class="input-wrapper">
                        <!-- 文件列表 - 显示已选择的文件 -->
                        <div class="file-list-container" id="fileListContainer" style="display: none;">
                            <div class="file-list-header">
                                <span>已选择文件:</span>
                                <button class="clear-files-btn" onclick="clearFileList()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="file-list" id="fileList"></div>
                        </div>
                        <textarea id="messageInput" placeholder="输入你的消息..." rows="3"></textarea>
                    </div>

                    <div class="input-actions">
                        <div class="config-info">
                            <span class="config-item">
                                <i class="fas fa-brain"></i>
                                <span id="currentModel">-</span>
                            </span>
                            <span class="config-item">
                                <i class="fas fa-thermometer-half"></i>
                                <span id="currentTemp">{{ '%.1f'|format(config.temperature|default(0.7)) }}</span>
                            </span>
                        </div>
                        <div class="input-buttons">
                            <!-- 简洁的文件上传按钮 -->
                            <div class="file-upload-btn-container">
                                <input type="file" id="fileInput" multiple style="display: none;">
                                <button id="uploadButton" class="btn-attach" title="上传文件">
                                    <i class="fas fa-paperclip"></i>
                                </button>
                                <div class="file-count-badge" id="fileCountBadge" style="display: none;">0</div>
                            </div>
                            <button id="sendButton" class="btn-send">
                                <i class="fas fa-paper-plane"></i> 发送
                            </button>
                        </div>
                    </div>
                </div>
                <div class="input-hint">
                    <small>按 Enter 发送，Shift + Enter 换行 • 支持上传文本、PDF、图片等文件</small>
                </div>
            </div>
        </div>
        <input type="hidden" id ="uid" name="uid" value="{{uid}}">
        <input type="hidden" id ="t" name="t" value="{{t}}">

        <footer class="footer">
            <p>Powered by Richard</p>
        </footer>
    </div>

    <script type="text/javascript" src="/static/highlight.11.8.0.min.js"></script>
    <script type="text/javascript" src="/static/marked.min.js"></script>
    <script type="text/javascript" src="/static/highlight.11.8.0.javascript.min.js"></script>

    <script type="text/javascript" src="/static/highlight.11.8.0.python.min.js"></script>
    <script type="text/javascript" src="/static/highlight.11.8.0.sql.min.js"></script>
    <script type="text/javascript" src="/static/highlight.11.8.0.css.min.js"></script>
    <script type="text/javascript" src="/static/highlight.11.8.0.json.min.js"></script>
    <script type="text/javascript" src="/static/highlight.11.8.0.bash.min.js"></script>
    <script type="text/javascript" src="/static/chat.js"></script>
</body>
</html>