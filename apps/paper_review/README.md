# AI 数字评委 (Paper Review) 应用

这是一个基于人工智能的文档评审系统，能够根据用户提供的评审标准和评审材料，自动生成专业的评审报告。

## 系统简介

AI 数字评委是一个利用大语言模型(LLM)进行智能文档评审的应用系统。用户只需提供评审标准和待评审材料，系统就能自动生成结构化的评审报告，包括评分、优点、问题和改进建议等内容。

## 功能特性

- **智能文档评审**: 基于AI技术自动分析文档内容并生成评审意见
- **多格式支持**: 支持Excel和Word格式的评审标准文件
- **结构化输出**: 自动生成包含评分、优缺点分析的标准化评审报告
- **实时进度跟踪**: 提供任务管理和进度监控功能
- **多样化导出**: 支持Word和Excel格式的评审报告下载

## 技术架构

### 核心组件

- [app.py](file:///home/rd/workspace/llm_agent/apps/csm/app.py): 主应用入口，包含Flask路由和业务逻辑
- [paper_reviewer.py](file:///home/rd/workspace/llm_agent/apps/paper_review/paper_reviewer.py): 核心评审逻辑处理模块
- 前端模板: `templates/`目录下的HTML模板文件
- 静态资源: `static/`目录下的CSS、JavaScript文件

### 主要依赖

- Python 3.12+
- Flask (Web框架)
- python-docx (Word文档处理)
- pandas (Excel处理)
- langchain/openai (LLM集成)
- requests (HTTP客户端)

## 使用流程

1. **登录系统**: 访问登录页面，进行身份验证
2. **创建评审任务**:
   - 填写评审主题和评审类别
   - 上传评审标准文件(Excel或Word格式)
   - 上传待评审材料文件(Word格式)
3. **提交评审任务**: 点击"生成评审报告"按钮提交任务
4. **监控进度**: 在"我的任务"页面查看实时进度
5. **获取结果**: 任务完成后预览或下载评审报告

## 文件处理流程

1. **文件上传**:
   - 评审标准文件支持.xlsx和.docx格式
   - 评审材料文件支持.docx格式
   - 系统自动转换为Markdown格式进行处理

2. **AI评审处理**:
   - 系统解析评审标准和材料内容
   - 调用LLM进行内容分析和评审
   - 生成结构化评审结果

3. **报告生成**:
   - 将评审结果填充到标准格式模板中
   - 支持导出为Word或Excel文档

## 部署要求

### 服务端要求
- Ubuntu 20.04+ 或类似Linux发行版
- Python 3.12+
- 可访问的LLM API服务

### 客户端要求
- 现代浏览器(推荐Chrome)

## 目录结构

```
apps/paper_review/
├── app.py                 # 主应用文件
├── paper_reviewer.py      # 核心评审处理模块
├── templates/             # HTML模板
├── static/                # 静态资源文件
├── user_manual/           # 用户手册
└── deploy/                # 部署脚本
```


## 评审标准文件要求

### Excel格式(.xlsx)
- 可包含多个工作表
- 每个工作表的表格内容将被转换为评审标准
- 建议表头清晰，内容结构化

### Word格式(.docx)
- 支持标准的Word文档格式
- 系统将抽取其中的文本作为评审标准
- 建议内容条理清晰，评审维度明确

## 输出报告格式

生成的评审报告包含以下内容:
- 整体评价和综合评分
- 各章节评审详情
- 具体问题和改进建议
- 风险等级评估

支持导出为.docx和.xlsx两种格式。
